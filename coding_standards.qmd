---
title: "R Coding Standards for Reproducibility"
format:
  revealjs:
    self-contained: true
execute:
  echo: true
  eval: false
  warning: false
  message: false
---

## What is `renv`?

- `renv` is an *R* package that helps make *R* projects **reproducible**
- It records:
  - Exact package versions used
  - Where packages came from (CRAN, Bioconductor, GitHub)
  - The *R* version used
- This allows collaborators, reviewers, and your future self to recreate the same *R* package environment on a different machine or at a later time

## How `renv` manages packages

- **Global cache**:
  - Stores one copy of each package version on your machine
  - Shared across *R* projects
- **Project library** (`renv/library/`):
  - Contains links to packages in the cache
  - Is project-specific
  - Should never be committed to git

This design saves disk space and ensures isolation between projects.

## Steps to initialize `renv` in an R project

1.  Run `install.packages("renv")`
2.  If project includes many files with no *R* code, consider adding them to `.renvignore` at the top level
    - E.g., add `figs/**` to ignore the folder `figs` and all its content
3.  Run `renv::init()` to store direct and indirect dependencies in `renv` package cache and add links to project library
4. Commit the suggested 5 files and `.renvignore` (if present) to git

## After `renv` is initialized

- Use `renv::install("pkgname")` to install a new package in the project library
- Use `renv::update()` to update all packages in the project library
- After installing or updating a package, use `renv::snapshot()` to update the lockfile `renv.lock` that contains *R* and *R* package metadata recording the state of the project library (and used to reproduce package environment by others or future self)

## Steps to create/update project library after `renv.lock` has been created/updated (e.g., by a collaborator)

- `renv` automatically bootstraps itself (i.e., downloads and installs) when a project is first opened in which `renv` has been activated by a collaborator
    - `.Rprofile` is involved
- Use `renv::restore()` to update/reproduce package environment as specified by `renv.lock`

## Limitation of `renv`

- `renv` records the **R version** but does not install *R* for you
- Collaborators must install a compatible *R* version separately

## Notes about `renv`

- Read **Introduction to renv**:<br> <https://rstudio.github.io/renv/articles/renv.html>
- Don't edit `renv.lock` manually
- Don't commit `renv/library` to git
    - `renv::init()` handles this automatically by including `library/` in `renv/.gitignore`
